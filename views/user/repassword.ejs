<%- include('../header'); %>
	<!-- BEGIN breadcrumb -->
	<ol class="breadcrumb float-xl-end">
		<li class="breadcrumb-item"><a href="javascript:;">Home</a></li>
		<li class="breadcrumb-item active">비밀번호 변경</li>
	</ol>
	<!-- END breadcrumb -->
	<!-- BEGIN page-header -->
	<h1 class="page-header mb-3">비밀번호 변경</h1>
	<!-- END page-header -->

	<div class="row">
		<div class="col">
			<div class="panel panel-inverse">
				<!-- <div class="panel-heading">
					<h4 class="panel-title">Profile</h4>
				</div> -->
				<div class="panel-body">
					<form role="form" method="post">
						<div class="mb-3">
							<label class="form-label">새 비밀번호</label>
							<input class="form-control" type="password" name="password" />
						</div>
						<div class="mb-3">
							<label class="form-label">새 비밀번호 확인</label>
							<input class="form-control" type="password" name="repassword" />
						</div>
						<div class="text-center">
							<button type="button" class="btn btn-primary w-100" onclick="do_modify(this.form);">확인</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>



	<script>
		function do_modify(f) {

			if (f.password.value || f.repassword.value) {
				if (pwUtils.validatePassword(f.password.value) == false) {
					f.password.focus();
					return;
				}

				if (f.password.value != f.repassword.value) {
					pwUtils.setAlert('The password does not match.');
					f.password.focus();
					return;
				}
			}

			send_info(f);
		}

		function send_info(f) {

			pwUtils.ajaxJSON(
				'/user/repassword',
				$(f).serialize(),
				(data) => {
					switch (data['result']) {
						case 100:
							pwUtils.swalSuccess('User infomation has been modified.'), () => { location.href = '/'; }
							break;
						default:
							pwUtils.setAlert(data['msg'] || 'Server error');
							break;
					}
				},
				(j) => {
					pwUtils.setAlert('Server error');
				});

		}
	</script>

	<%- include('../footer'); %>